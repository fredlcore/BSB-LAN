<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://docs.bsb-lan.de/homeautomation.html">
        <link rel="shortcut icon" href="img/favicon.ico">
        <title>Connect to your Smart Home - BSB-LAN</title>
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <link href="css/fontawesome.min.css" rel="stylesheet">
        <link href="css/brands.min.css" rel="stylesheet">
        <link href="css/solid.min.css" rel="stylesheet">
        <link href="css/v4-font-face.min.css" rel="stylesheet">
        <link href="css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <link href="style.css" rel="stylesheet">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="index.html">BSB-LAN</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="index.html" class="nav-link">Overview</a>
                            </li>
                            <li class="nav-item">
                                <a href="quickstart.html" class="nav-link">Quickstart</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">How it works</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="supported_heating_systems.html" class="dropdown-item">Supported Heating Systems</a>
</li>
                                    
<li>
    <a href="bsb-lan_adapter.html" class="dropdown-item">The BSB-LAN Adapter</a>
</li>
                                    
<li>
    <a href="bus_systems.html" class="dropdown-item">The BSB/LPB/PPS Bus</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">How to set it up</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="install.html" class="dropdown-item">Installation</a>
</li>
                                    
<li>
    <a href="configure.html" class="dropdown-item">Configuration</a>
</li>
                                    
<li>
    <a href="CHANGELOG.html" class="dropdown-item">ChangeLog</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">How to use it</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="using.html" class="dropdown-item">BSB-LAN's functions</a>
</li>
                                    
<li>
    <a href="homeautomation.html" class="dropdown-item active" aria-current="page">Connect to your Smart Home</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Help!</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="troubleshooting.html" class="dropdown-item">Troubleshooting</a>
</li>
                                    
<li>
    <a href="faq.html" class="dropdown-item">FAQ</a>
</li>
                                    
<li>
    <a href="https://github.com/fredlcore/BSB-LAN/wiki" class="dropdown-item">Wiki</a>
</li>
                                    
<li>
    <a href="https://www.youtube.com/@BSB-LAN" class="dropdown-item">YouTube Tutorials</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">üåê</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="/de/" class="dropdown-item">Deutsch</a>
</li>
                                    
<li>
    <a href="/" class="dropdown-item">English</a>
</li>
                                    
<li>
    <a href="/fr/" class="dropdown-item">Fran√ßais</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="using.html" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="troubleshooting.html" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#connecting-bsb-lan-to-home-automation-systems" class="nav-link">Connecting BSB-LAN to home automation systems</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#using-supported-modules-for-specific-home-automation-systems" class="nav-link">Using supported modules for specific home automation systems</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#exchanging-data-via-mqtt" class="nav-link">Exchanging data via MQTT</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#exchanging-data-via-json" class="nav-link">Exchanging data via JSON</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#exchanging-data-via-url-commands-and-screen-scraping" class="nav-link">Exchanging data via URL commands and screen scraping</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="connecting-bsb-lan-to-home-automation-systems">Connecting BSB-LAN to home automation systems</h1>
<p>BSB-LAN provides four ways to connect to home automation systems:  </p>
<ol>
<li>Using supported modules for specific home automation systems</li>
<li>Exchanging data via MQTT</li>
<li>Exchanging data via JSON</li>
<li>Exchanging data via URL commands and screen scraping</li>
</ol>
<hr />
<h2 id="using-supported-modules-for-specific-home-automation-systems">Using supported modules for specific home automation systems</h2>
<p>For some systems, specific modules exist that can be used to access BSB-LAN seamlessly:
<a href="" id="HomeAssistant"></a></p>
<h3 id="home-assistant">Home Assistant</h3>
<p>While the official plugin no longer works, the MQTT approach (see below) works well with Home Assistant, including the auto-discovery feature.<br />
Here is a link to a <a href="https://youtu.be/DbHEiWm5nBs">video in the BSB-LAN YouTube channel</a> that shows how to set up BSB-LAN in Home Assistant using the auto-discovery feature of Home Assistant.</p>
<p>For further details of the implementation, you may also refer to these tutorials:</p>
<p>GitHub user @ryann72 wrote detailed instructions for <a href="https://github.com/ryann72/Home-assistant-tutoriel/blob/main/BSB-LAN/tutoriel%20BSB-LAN%20English.md">BSB-LAN and HomeAssistant/Mosquitto</a>. It is also available in <a href="https://github.com/ryann72/Home-assistant-tutoriel/blob/main/BSB-LAN/tutoriel%20BSB-LAN.md">French</a>.</p>
<p>YouTuber @StoneTime has created two videos (in German) where he shows the <a href="https://www.youtube.com/watch?v=n-5I-TUzXuk">installation of BSB-LAN</a> as well as <a href="https://www.youtube.com/watch?v=R2Q-_flTPvk">setting it up in Home Assistant</a>. Dankesch√∂n!</p>
<p>YouTuber @ArminasTV has created two videos (in French) where he shows the <a href="https://www.youtube.com/watch?v=5lNgNYlZ7M0&amp;t=0s">installation of BSB-LAN</a> as well as how to set it up with <a href="https://www.youtube.com/watch?v=WtmKPo1xMio&amp;t=411s">Home Assistant and MQTT</a>. Merci beacoup!</p>
<p><a href="" id="Homebridge"></a></p>
<h3 id="homebridge">Homebridge</h3>
<p>BSB-LAN user Michael has written a <a href="https://www.npmjs.com/package/@bsblan/homebridge-bsblan-thermostat">plugin for Homebridge</a>. Thank you!</p>
<p><a href="" id="ioBroker"></a></p>
<h3 id="iobroker">ioBroker</h3>
<p>GitHub user @hacki11 has developed <a href="https://github.com/hacki11/ioBroker.bsblan">an adapter for ioBroker</a>. Thank you!</p>
<p><a href="" id="Jeedom"></a></p>
<h3 id="jeedom">Jeedom</h3>
<p>GitHub user @bernard-dandrea has written a <a href="https://bernard-dandrea.github.io/jeedom-BSBLAN/fr_FR/">plugin for Jeedom</a> (with a French description). Thank you!</p>
<p><a href="" id="NodeRED"></a></p>
<h3 id="node-red">Node-RED</h3>
<p>GitHub user @konne wrote a <a href="https://github.com/node-red-contrib/node-red-contrib-bsb-lan">module for Node-RED</a>. Thank you!</p>
<p><a href="" id="FHEM"></a></p>
<h3 id="fhem">FHEM</h3>
<p>FHEM forum user Luposoft has written a compact <a href="https://forum.fhem.de/index.php/topic,29762.msg1129702.html#msg1129702">explanation</a> of the configuration for using FHEM via MQTT. Thank you!</p>
<p><a href="" id="openHAB"></a></p>
<h3 id="openhab">openHAB</h3>
<p>Since version 2.5.4, there exists a <a href="https://www.openhab.org/addons/bindings/bsblan/">binding</a> that is officially part of OpenHAB.</p>
<p><a href="" id="Homematic"></a></p>
<h3 id="homematic">Homematic</h3>
<p>FHEM forum user PaulM has <a href="https://forum.fhem.de/index.php?topic=29762.1830">written a few scripts</a> to showcase the integration of BSB-LAN into Homematic. Thank you!</p>
<p><a href="" id="SmartHomeNG"></a></p>
<h3 id="smarthomeng">SmartHomeNG</h3>
<p>GitHub user @thensty wrote a <a href="https://github.com/smarthomeNG/plugins/tree/develop/bsblan">plugin for SmartHomeNG</a>. Thank you!</p>
<p><a href="" id="Volkszaehler"></a></p>
<h3 id="volkszaehler">Volkszaehler</h3>
<p>GitHub user @lapixo has contributed a <a href="https://github.com/lapixo/volkszaehler_bsb-lan/tree/main">script for the Volkszaehler project</a>. Thank you!</p>
<p><a href="" id="Bash"></a></p>
<h3 id="bash-script">Bash script</h3>
<p>GitHub user @khfm has written <a href="https://github.com/khfm/bsb-lan-readout">Bash scripts</a> to query data and display it using gnuplot. Thank you!</p>
<hr />
<p><a href="" id="MQTT"></a></p>
<h2 id="exchanging-data-via-mqtt">Exchanging data via MQTT</h2>
<p>This is the recommended way to connect BSB-LAN to home automation systems because it allows seamless exchange of data.<br />
As a prerequisite, a MQTT broker (such as <a href="https://mosquitto.org">mosquitto</a>) is needed, either running locally or via making use of a public service. Some home automation systems such as Home Assistant offer the installation of mosquitto as part of their software.</p>
<p><strong>Attention:</strong> Currently, the mosquitto broker seems to have an issue with handling larger numbers of messages from versions 2.0.16 onwards (<a href="https://github.com/eclipse-mosquitto/mosquitto/issues/2887">see this bug report</a>). If you encounter the problem that your BSB-LAN entities become "unavailable", especially after using the auto-discovery feature below, please downgrade to mosquitto version 2.0.15. However, be aware that this version has security issues, so make sure that your broker runs at least in a firewalled environment.  </p>
<p>In BSB-LAN, you need to make or enable at least the following configurations:</p>
<ul>
<li>Set <strong>Logging mode</strong> (additionally) to <strong>Send to MQTT Broker</strong>.</li>
<li>Set <strong>Log Interval</strong> to the time (in seconds) you want the log parameters to be published. </li>
<li>Select up to 20 <strong>Log Parameters</strong> you want to be sent to your home automation system.</li>
<li>Set <strong>MQTT Usage</strong> to <strong>plain text</strong>.</li>
<li>Set <strong>MQTT Broker Server</strong> to the hostname of your MQTT broker (such as the mosquitto server).</li>
</ul>
<p>If your home automation system supports MQTT auto-discovery (as is the case with Home Assistant), you can call URL command <code>/M1!&lt;x&gt;</code> and BSB-LAN will send auto-discovery messages for <strong>all available parameters</strong> from device ID <code>&lt;x&gt;</code> to the MQTT broker and thus to the home automation system. Please take note that if you don't have write-enabled parameters in BSB-LAN, all parameters will be reported as read-only parameters in Home Assistant. If you later change that setting in BSB-LAN, you have to start the auto-discovery process again.<br />
You may have to clean up afterwards or send a removal message for all these parameters using URL command <code>/M0!&lt;x&gt;</code> if you don't want to use this feature anymore.  </p>
<p>Otherwise, if you want to set up your own connection details, the topic structure of BSB-LAN is as follows:<br />
<code>&lt;BSB-LAN MQTT Topic&gt;/&lt;device ID&gt;/&lt;category no.&gt;/&lt;parameter no.&gt;</code><br />
whereas  </p>
<ul>
<li><code>&lt;BSB-LAN MQTT Topic&gt;</code> is defined in BSB-LAN's settings (defaults to <code>BSB-LAN</code>),  </li>
<li><code>&lt;device ID&gt;</code> is the ID of the heating controller (usually <code>0</code> for the main controller),  </li>
<li><code>&lt;category no.&gt;</code> is the category number as it is used with URL-command <code>/K</code>,  </li>
<li><code>&lt;parameter no.&gt;</code> is the parameter number, such as <code>501.1</code>.  </li>
</ul>
<p>This structure is followed by one of these topics that determine the action to be performed:  </p>
<ul>
<li><code>/status</code> - contains the value of the parameter in the MQTT payload.  </li>
<li><code>/set</code> - used to set a parameter with the value contained in the published MQTT payload using the SET telegram (default way of setting parameters).  </li>
<li><code>/inf</code> - same as <code>/set</code>, but uses the INF telegram (used for sending room temperature parameter 10000, for example).</li>
<li><code>/poll</code> - ignores the published value and forces BSB-LAN to immediately update <code>/status</code> of the same parameter with a freshly retrieved parameter value. <code>/poll</code> can also be accessed directly below the main topic (e.g. <code>BSB-LAN/poll</code>) where it accepts a list of parameters separated by comma. These parameters will then immediately have their respective <code>/status</code> topics updated in one go. Addressing parameters can either be done in topic-style (with leading slash) or similar to the list of logging parameters in BSB-LAN's settings (see examples below).  </li>
</ul>
<p>At the same time, the legacy way of sending URL commands via MQTT directly to the main topic (as defined in the settings, defaulting to <code>BSB-LAN</code>), is still supported for compatibility reasons, but deprecated. Responses will always be written to <code>/status</code> of the above mentioned topic structure.  </p>
<p>The <code>/status</code> topic is updated in four ways:</p>
<ul>
<li>via logging parameters to MQTT as explained above</li>
<li>every time a URL query is made to BSB-LAN (can be disabled by <strong>activating</strong> <code>Only send log parameters to MQTT</code> in configuration)</li>
<li>every time a parameter is changed through the room unit (can be disabled by <strong>activating</strong> <code>Only send log parameters to MQTT</code> in configuration)</li>
<li>every time the parameter is updated via the <code>/poll</code> topic as explained above</li>
</ul>
<p>In these cases, the respective values of the parameters affected will be sent to the MQTT broker, so even changes made outside of BSB-LAN are sent to the home automation system, which is why the MQTT approach is the recommended way to connect to a home automation system.<br />
This also means that, as an alternative to the built-in logging feature of BSB-LAN, you can also just periodically call a URL with the parameters you want to see updated. Since these parameters will also be sent to the MQTT broker, your home automation system will receive them as well.<br />
For example, if you periodically call the URL <code>http://bsb-lan.local/700/8700</code>, both the operating mode of heat circuit 1 (parameter 700) as well as the current outside temperature (parameter 8700) will be sent to the MQTT broker.</p>
<h3 id="examples-for-querying-or-setting-parameters-via-mqtt-using-mosquitto">Examples for querying or setting parameters via MQTT using mosquitto</h3>
<p>Query the outside temperature (device ID 0, category no. 51, parameter 8700):<br />
<code>mosquitto_sub -h my.mosquitto-broker.local -u USER -P PASSWORD -t BSB-LAN/0/51/8700/status</code>  </p>
<p>Set the comfort temperature setpoint (device ID 0, category no. 16, parameter 710) to 20 degrees:<br />
<code>mosquitto_pub -h my.mosquitto-broker.local -u USER -P PASSWORD -m "20" -t BSB-LAN/0/16/710/set</code>  </p>
<p>Force immediate update of outside temperature (device ID 0, category no. 51, parameter 8700):<br />
<code>mosquitto_pub -h my.mosquitto-broker.local -u USER -P PASSWORD -m "" -t BSB-LAN/0/51/8700/poll</code>  </p>
<p>Force immediate update of parameters 700 and 8700 from default device as well as parameter 8326 from device ID 1:<br />
<code>mosquitto_pub -h my.mosquitto-broker.local -u USER -P PASSWORD -m "700,8700,8326!1" -t BSB-LAN/poll</code><br />
or<br />
<code>mosquitto_pub -h my.mosquitto-broker.local -u USER -P PASSWORD -m "/0/16/700,/0/51/8700,/1/50/8326" -t BSB-LAN/poll</code>  </p>
<p><strong>Attention:</strong> Take note that the category number differs from system to system and has to be compared with your system first!</p>
<hr />
<p><a href="" id="JSON"></a></p>
<h2 id="exchanging-data-via-json">Exchanging data via JSON</h2>
<p>BSB-LAN allows to query and set parameters via JSON structures and also provides numerous information about the parameters and category structures this way. The JSON API is accessd via <a href="using.html">URL commands</a> and the <code>openapi.yaml</code> file provided in this repository can be used with <a href="https://editor.swagger.io/?url=https://raw.githubusercontent.com/fredlcore/bsb_lan/master/openapi.yaml">Swagger</a> to explore its possibilities and functionalitites.</p>
<hr />
<h2 id="exchanging-data-via-url-commands-and-screen-scraping">Exchanging data via URL commands and screen scraping</h2>
<p>For simpler solutions, <a class="autorefs autorefs-internal" href="using.html#using-bsb-lans-url-commands">using the URL commands</a> to query and set parameters can be used to control BSB-LAN from other systems. Screen scraping is possible since the project tries not to break certain ways of displaying data, so that parsing with regular expressions remains feasible. Nevertheless, for most scenarios one of the other options will probably be preferrable.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = ".",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="js/base.js"></script>
        <script src="search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
